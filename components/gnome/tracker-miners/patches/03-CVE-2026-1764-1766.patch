https://gitlab.gnome.org/GNOME/localsearch/-/commit/5337e2977f159c29e2b8af575e56866862af241b
https://gitlab.gnome.org/GNOME/localsearch/-/commit/79f47309bad068ff0c19c1431abab6766edc687f
https://gitlab.gnome.org/GNOME/localsearch/-/commit/9cc562cc126c408efb2a8220fcd67f006902412c

CVE-2026-1767 doesn't apply since performer tags were added in a later version

--- a/src/tracker-extract/tracker-extract-mp3.c	2026-02-06 17:32:37.005339370 -0800
+++ b/src/tracker-extract/tracker-extract-mp3.c	2026-02-06 17:37:19.040150915 -0800
@@ -1424,8 +1424,10 @@
 	text_desc     = &data[pos + 4]; /* <text string according to encoding> $00 (00) */
 	text_desc_len = id3v2_strlen (text_encode, text_desc, csize - 4);
 
-	offset        = 4 + text_desc_len + id3v2_nul_size (text_encode);
-	text          = &data[pos + offset]; /* <full text string according to encoding> */
+	offset = 4 + text_desc_len + id3v2_nul_size (text_encode);
+	if (pos + offset >= csize)
+		return;
+	text = &data[pos + offset]; /* <full text string according to encoding> */
 
 	if (version == 2.3f) {
 		description = id3v2_text_to_utf8 (data[pos], &data[pos + 1], csize - 1, info);
@@ -1498,6 +1500,46 @@
 	tag->mb_recording_id = identifier;
 }
 
+static void    
+extract_comm_tag (id3v2tag    *tag,
+                  const gchar *data,
+                  guint        pos,
+                  size_t       csize,
+                  id3tag      *info,
+                  gfloat       version)
+{
+       gchar *word = NULL;
+       gchar text_encode;
+       const gchar *text_desc; 
+       const gchar *text;    
+       guint offset;
+       gint text_desc_len;
+               
+       text_encode =  data[pos + 0]; /* $xx */
+       text_desc = &data[pos + 4]; /* <text string according to encoding> $00 (00) */
+       text_desc_len = id3v2_strlen (text_encode, text_desc, csize - 4);
+
+       offset = 4 + text_desc_len + id3v2_nul_size (text_encode);
+                       
+       if (offset >= csize)
+               return; 
+               
+       text = &data[pos + offset]; /* <full text string according to encoding> */
+               
+       if (version == 2.3f)
+               word = id3v2_text_to_utf8 (text_encode, text, csize - offset, info);
+       else    
+               word = id3v24_text_to_utf8 (text_encode, text, csize - offset, info);
+
+       if (!tracker_is_empty_string (word)) {
+               g_strstrip (word);
+               g_free (tag->comment);
+               tag->comment = word;
+       } else {
+               g_free (word);
+       }
+}
+
 static void
 get_id3v24_tags (id3v24frame           frame,
                  const gchar          *data,
@@ -1538,32 +1580,7 @@
 	}
 
 	case ID3V24_COMM: {
-		gchar *word;
-		gchar text_encode;
-		const gchar *text_desc;
-		const gchar *text;
-		guint offset;
-		gint text_desc_len;
-
-		text_encode   =  data[pos + 0]; /* $xx */
-		text_desc     = &data[pos + 4]; /* <text string according to encoding> $00 (00) */
-		text_desc_len = id3v2_strlen (text_encode, text_desc, csize - 4);
-
-		offset        = 4 + text_desc_len + id3v2_nul_size (text_encode);
-		text          = &data[pos + offset]; /* <full text string according to encoding> */
-
-		if (offset >= csize)
-			break;
-
-		word = id3v24_text_to_utf8 (text_encode, text, csize - offset, info);
-
-		if (!tracker_is_empty_string (word)) {
-			g_strstrip (word);
-			g_free (tag->comment);
-			tag->comment = word;
-		} else {
-			g_free (word);
-		}
+		extract_comm_tag (tag, data, pos, csize, info, 2.4f);
 		break;
 	}
 
@@ -1741,30 +1758,7 @@
 	}
 
 	case ID3V24_COMM: {
-		gchar *word;
-		gchar text_encode;
-		const gchar *text_desc;
-		const gchar *text;
-		guint offset;
-		gint text_desc_len;
-
-		text_encode   =  data[pos + 0]; /* $xx */
-		text_desc     = &data[pos + 4]; /* <text string according to encoding> $00 (00) */
-		text_desc_len = id3v2_strlen (text_encode, text_desc, csize - 4);
-
-		offset        = 4 + text_desc_len + id3v2_nul_size (text_encode);
-		text          = &data[pos + offset]; /* <full text string according to encoding> */
-
-		word = id3v2_text_to_utf8 (text_encode, text, csize - offset, info);
-
-		if (!tracker_is_empty_string (word)) {
-			g_strstrip (word);
-			g_free (tag->comment);
-			tag->comment = word;
-		} else {
-			g_free (word);
-		}
-
+		extract_comm_tag (tag, data, pos, csize, info, 2.4f);
 		break;
 	}
 
