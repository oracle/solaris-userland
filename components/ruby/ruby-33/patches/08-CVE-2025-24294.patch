Fixes CVE-2025-24294.

Backported from upstream:
https://github.com/ruby/resolv/commit/24ed513f028d8e5c76310fcdecf07f79eb721a32

--- ruby-3.3.9/lib/rubygems/vendor/resolv/lib/resolv.rb
+++ ruby-3.3.9/lib/rubygems/vendor/resolv/lib/resolv.rb
@@ -1648,6 +1648,7 @@ class Gem::Resolv
           prev_index = @index
           save_index = nil
           d = []
+          size = -1
           while true
             raise DecodeError.new("limit exceeded") if @limit <= @index
             case @data.getbyte(@index)
@@ -1668,7 +1669,10 @@ class Gem::Resolv
               end
               @index = idx
             else
-              d << self.get_label
+              l = self.get_label
+              d << l
+              size += 1 + l.string.bytesize
+              raise DecodeError.new("name label data exceed 255 octets") if size > 255
             end
           end
         end
