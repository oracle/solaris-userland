patch from https://gitlab.com/libtiff/libtiff/merge_requests/44.diff


diff --git a/tools/tiffcp.c b/tools/tiffcp.c
index 2f406e2d7065d31e2fccee0c08871cdab1d07fb7..ece7ba1364c6f7224434a69ede1df932778d216b 100644
--- a/tools/tiffcp.c
+++ b/tools/tiffcp.c
@@ -1435,6 +1435,12 @@ DECLAREreadFunc(readSeparateTilesIntoBuffer)
             status = 0;
             goto done;
         }
+        if (0xFFFFFFFF / tilew < spp)
+        {
+            TIFFError(TIFFFileName(in), "Error, either TileWidth (%u) or BitsPerSample (%u) is too large", tilew, bps);
+            status = 0;
+            goto done;
+        }
 	bytes_per_sample = bps/8;
 
 	for (row = 0; row < imagelength; row += tl) {

