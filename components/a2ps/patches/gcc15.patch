From 2aaa886a11ddd8246df037c3d35e0f7c199efed0 Mon Sep 17 00:00:00 2001
From: Reuben Thomas <rrt@sc3d.org>
Date: Fri, 11 Jul 2025 08:00:41 +0100
Subject: Yacc parsers: remove non-C23-compliant debug code
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

At this stage itâ€™s probably better to remove the unused debug code than fix
it: our built-in language highlighting is obsolete in any case.

Thanks to Adam Sampson for the report of the problem and the patch.
---
 liba2ps/parseppd.y | 23 -----------------------
 src/parsessh.y     | 32 --------------------------------
 2 files changed, 55 deletions(-)

diff --git a/liba2ps/parseppd.y b/liba2ps/parseppd.y
index df4d863..fa457df 100644
--- a/liba2ps/parseppd.y
+++ b/liba2ps/parseppd.y
@@ -42,7 +42,6 @@
 
 #define YYDEBUG 1
 #define YYERROR_VERBOSE 1
-#define YYPRINT(file, type, value)   yyprint (file, type, value)
 
 /* Comes from the caller */
 extern FILE * ppdin;
@@ -50,7 +49,6 @@ extern struct a2ps_job * job;
 
 /* Local prototypes */
 void yyerror (const char *msg);
-static void yyprint ();
 
 /* Initilizes the obstacks */
 void ppdlex_initialize (void);
@@ -150,27 +148,6 @@ yyerror (const char *msg)
   error_at_line (1, 0, ppdfilename, ppdlineno, "%s", msg);
 }
 
-/*
- * For debugging
- */
-static void
-yyprint (FILE *file, int type, YYSTYPE value)
-{
-  switch (type) {
-  case STRING:
-    fprintf (file, " \"%s\"", value.string);
-    break;
-
-  case SYMBOL:
-    fprintf (file, " %s", value.string);
-    break;
-
-  case USTRING:
-    fprintf (file, " u\"%s\"", value.ustring);
-    break;
-  }
-}
-
 struct ppd *
 a2ps_ppd_parse (const char * filename, char * const * path)
 {
diff --git a/src/parsessh.y b/src/parsessh.y
index 0a151c7..84d5be3 100644
--- a/src/parsessh.y
+++ b/src/parsessh.y
@@ -42,7 +42,6 @@
 
 #define YYDEBUG 1
 #define YYERROR_VERBOSE 1
-#define YYPRINT(file, type, value)   yyprint (file, type, value)
 
 /* We need to use the same `const' as bison, to avoid the following
    prototypes to diverge from the function declarations */
@@ -63,7 +62,6 @@ extern const char * sshfilename;
 
 /* Local prototypes */
 void yyerror (const char *msg);
-static void yyprint ();
 
 /* Initilizes the obstacks */
 void sshlex_initialize (void);
@@ -728,36 +726,6 @@ yyerror (const char *msg)
   error_at_line (1, 0, sshfilename, sshlineno, "%s", msg);
 }
 
-/*
- * FIXME: Cover the other relevant types
- */
-static void
-yyprint (FILE *file, int type, YYSTYPE value)
-{
-  switch (type) {
-  case tBACK_REF:
-    fprintf (file, " \\%d", value.integer);
-    break;
-
-  case tFFLAGS:
-    putc (' ', file);
-    fflag_self_print (value.fflags, file);
-    break;
-
-  case tFACE:
-    fprintf (file, " %s", face_to_string (value.face));
-    break;
-
-  case tREGEX:
-    fprintf (file, " /%s/", value.pattern->pattern);
-    break;
-
-  case tSTRING:
-    fprintf (file, " \"%s\"", value.string);
-    break;
-  }
-}
-
 struct style_sheet *
 parse_style_sheet (const char * filename)
 {
-- 
cgit v1.2.3

